{"version":3,"sources":["keditor-component-form.js"],"names":["$","KEditor","keditor","flog","log","components","initFormBuilder","component","self","this","formBuilderArea","find","formData","formContent","prepend","btnEditForm","btnPreviewForm","formBuilder","disableInjectedStyle","showActionButtons","dataType","html","disableFields","disabledAttrs","typeUserDisabledAttrs","checkbox-group","on","e","preventDefault","hasClass","show","hide","addClass","removeClass","renderForm","data","formRender","actions","getData","children","each","div","dataGrid","attr","split","wrap","label","input","subDiv","length","init","contentArea","container","componentContent","append","getContent","remove","settingEnabled","settingTitle","initSettingForm","form","getSettingComponent","value","css","showSettingForm","layout","val","jQuery"],"mappings":"CAAA,SAAWA,GACP,GAAIC,GAAUD,EAAEE,QACZC,EAAOF,EAAQG,GAEnBH,GAAQI,WAAiB,MACrBC,gBAAiB,SAAUC,GACvB,GAAIC,GAAOC,KAEPC,EAAkBH,EAAUI,KAAK,sBACjCC,EAAWL,EAAUI,KAAK,cAC1BE,EAAcN,EAAUI,KAAK,gBAEjCJ,GAAUI,KAAK,8BAA8BG,QACzC,mNAMJ,IAAIC,GAAcR,EAAUI,KAAK,kBAC7BK,EAAiBT,EAAUI,KAAK,oBAEpCD,GAAgBO,aACZC,sBAAsB,EACtBC,mBAAmB,EACnBC,SAAU,OACVR,SAAUA,EAASS,OACnBC,eACI,eACA,YACA,UAEJC,eAAgB,UAEhBC,uBACIC,kBACI,SACA,aAKZV,EAAYW,GAAG,QAAS,SAAUC,GAC9BA,EAAEC,iBAEGb,EAAYc,SAAS,cACtBnB,EAAgBoB,OAChBjB,EAAYkB,OACZhB,EAAYiB,SAAS,YACrBhB,EAAeiB,YAAY,eAInCjB,EAAeU,GAAG,QAAS,SAAUC,GACjCA,EAAEC,iBAEGZ,EAAea,SAAS,cACzBrB,EAAK0B,WAAW3B,GAEhBG,EAAgBqB,OAChBlB,EAAYiB,OACZf,EAAYkB,YAAY,YACxBjB,EAAegB,SAAS,gBAKpCE,WAAY,SAAU3B,EAAWU,GAC7B,GAAIJ,GAAcN,EAAUI,KAAK,gBAEjC,KAAKM,EAAa,CACd,GAAIP,GAAkBH,EAAUI,KAAK,qBACrCM,GAAcP,EAAgByB,KAAK,eAGvCtB,EAAYuB,YACRhB,SAAU,OACVR,SAAUK,EAAYoB,QAAQC,QAAQ,UAGtCzB,EAAYgB,SAAS,oBACrBhB,EAAY0B,SAAS,OAAOC,KAAK,WAC7B,GAAIC,GAAMzC,EAAES,MACRiC,EAAW7B,EAAY8B,KAAK,cAAgB,KAGhD,IAFAD,EAAWA,EAASE,MAAM,KAEtBH,EAAIE,KAAK,SACT,GAAIF,EAAIZ,SAAS,aACbY,EAAI9B,KAAK,UAAUkC,KAAK,sBAAwBH,EAAS,GAAK,kBAAoBA,EAAS,GAAK,gBAC7F,CACH,GAAII,GAAQL,EAAIF,SAAS,SACrBQ,EAAQN,EAAIF,SAAS,2BACrBS,EAASP,EAAIF,SAAS,MAE1BO,GAAMd,SAAS,wBAA0BU,EAAS,IAE9CM,EAAOC,OAAS,EAChBD,EAAOhB,SAAS,UAAYU,EAAS,IAErCK,EAAMf,SAAS,gBAAgBa,KAAK,sBAAwBH,EAAS,GAAK,gBAQlGQ,KAAM,SAAUC,EAAaC,EAAW7C,EAAWL,GAC/CC,EAAK,wBAAyBI,EAE9B,IAAI8C,GAAmB9C,EAAUI,KAAK,8BAClCM,EAAcV,EAAUI,KAAK,sBAC7BE,EAAcN,EAAUI,KAAK,iBAC7BC,EAAWL,EAAUI,KAAK,aAEN,KAApBC,EAASqC,QACTI,EAAiBC,OAAO,mEAGD,IAAvBzC,EAAYoC,OACZI,EAAiBC,OAAO,wEAExBzC,EAAYkB,OAGW,IAAvBd,EAAYgC,SACZhC,EAAcjB,EAAE,kDAChBqD,EAAiBC,OAAOrC,IAG5BR,KAAKH,gBAAgBC,IAGzBgD,WAAY,SAAUhD,EAAWL,GAC7BC,EAAK,8BAA+BI,EAEpC,IAAIC,GAAOC,KACP4C,EAAmB9C,EAAUI,KAAK,8BAClCC,EAAWL,EAAUI,KAAK,cAC1BD,EAAkBV,EAAE,IAAMO,EAAUoC,KAAK,OAAOhC,KAAK,sBACrDM,EAAcP,EAAgByB,KAAK,cAOvC,OALA3B,GAAK0B,WAAW3B,EAAWU,GAC3BL,EAASS,KAAKJ,EAAYoB,QAAQC,QAAQ,SAC1C/B,EAAUI,KAAK,2CAA2C6C,SAC1DjD,EAAUI,KAAK,iBAAiBmB,OAEzBuB,EAAiBhC,QAG5BoC,gBAAgB,EAEhBC,aAAc,gBAEdC,gBAAiB,SAAUC,EAAM1D,GAC7BC,EAAK,mCAEL,IAAIK,GAAOC,IAEXmD,GAAKvC,KACD,mkEAuDJuC,EAAKjD,KAAK,oBAAoBe,GAAG,SAAU,WACvC,GAAInB,GAAYL,EAAQ2D,sBACpBhD,EAAcN,EAAUI,KAAK,gBAEjCE,GAAY8B,KAAK,SAAUlC,KAAKqD,SAGpCF,EAAKjD,KAAK,kBAAkBe,GAAG,SAAU,WACrC,GAAInB,GAAYL,EAAQ2D,sBACpBhD,EAAcN,EAAUI,KAAK,gBAEjCE,GAAY8B,KAAK,SAAUlC,KAAKqD,SAGpCF,EAAKjD,KAAK,mBAAmBe,GAAG,SAAU,WACtC,GAAInB,GAAYL,EAAQ2D,sBACpBhD,EAAcN,EAAUI,KAAK,gBAEjCE,GAAY8B,KAAK,UAAWlC,KAAKqD,SAGrCF,EAAKjD,KAAK,kBAAkBe,GAAG,SAAU,WACrC,GAAInB,GAAYL,EAAQ2D,sBACpBhD,EAAcN,EAAUI,KAAK,gBAEjCE,GAAYoB,YAAY,+BACpBxB,KAAKqD,OACLjD,EAAYmB,SAASvB,KAAKqD,OAE9BtD,EAAK0B,WAAW3B,GAChBqD,EAAKjD,KAAK,wBAAwBoD,IAAI,UAA0B,oBAAftD,KAAKqD,MAA8B,QAAU,UAGlGF,EAAKjD,KAAK,gBAAgBe,GAAG,SAAU,WACnC,GAAInB,GAAYL,EAAQ2D,sBACpBhD,EAAcN,EAAUI,KAAK,gBAEjCE,GAAY8B,KAAK,YAAalC,KAAKqD,OACnCtD,EAAK0B,WAAW3B,MAIxByD,gBAAiB,SAAUJ,EAAMrD,EAAWL,GACxCC,EAAK,mCAAoCI,EACzC,IAAIM,GAAcN,EAAUI,KAAK,iBAE7BsD,EAAS,EACTpD,GAAYgB,SAAS,eACrBoC,EAAS,cACFpD,EAAYgB,SAAS,qBAC5BoC,EAAS,mBAGbL,EAAKjD,KAAK,oBAAoBuD,IAAIrD,EAAY8B,KAAK,WAAa,IAChEiB,EAAKjD,KAAK,kBAAkBuD,IAAIrD,EAAY8B,KAAK,WAAa,OAC9DiB,EAAKjD,KAAK,mBAAmBuD,IAAIrD,EAAY8B,KAAK,YAClDiB,EAAKjD,KAAK,kBAAkBuD,IAAID,GAChCL,EAAKjD,KAAK,wBAAwBoD,IAAI,UAAsB,oBAAXE,EAA+B,QAAU,QAC1FL,EAAKjD,KAAK,gBAAgBuD,IAAIrD,EAAY8B,KAAK,cAAgB,UAIxEwB","file":"keditor-component-form.min.js","sourcesContent":["(function ($) {\n    var KEditor = $.keditor;\n    var flog = KEditor.log;\n    \n    KEditor.components['form'] = {\n        initFormBuilder: function (component) {\n            var self = this;\n            \n            var formBuilderArea = component.find('.form-builder-area');\n            var formData = component.find('.form-data');\n            var formContent = component.find('.form-content');\n            \n            component.find('.keditor-component-content').prepend(\n                '<p class=\"form-builder-tools\" style=\"text-align: right;\">' +\n                '    <a href=\"#\" class=\"btn btn-primary btn-preview-form\">Preview form</a> ' +\n                '    <a href=\"#\" class=\"btn btn-info btn-edit-form disabled\">Edit form</a>' +\n                '</p>'\n            );\n            \n            var btnEditForm = component.find('.btn-edit-form');\n            var btnPreviewForm = component.find('.btn-preview-form');\n            \n            formBuilderArea.formBuilder({\n                disableInjectedStyle: true,\n                showActionButtons: false,\n                dataType: 'json',\n                formData: formData.html(),\n                disableFields: [\n                    'autocomplete',\n                    'paragraph',\n                    'header'\n                ],\n                disabledAttrs: ['access'],\n                \n                typeUserDisabledAttrs: {\n                    'checkbox-group': [\n                        'toggle',\n                        'inline'\n                    ]\n                }\n            });\n            \n            btnEditForm.on('click', function (e) {\n                e.preventDefault();\n                \n                if (!btnEditForm.hasClass('disabled')) {\n                    formBuilderArea.show();\n                    formContent.hide();\n                    btnEditForm.addClass('disabled');\n                    btnPreviewForm.removeClass('disabled');\n                }\n            });\n            \n            btnPreviewForm.on('click', function (e) {\n                e.preventDefault();\n                \n                if (!btnPreviewForm.hasClass('disabled')) {\n                    self.renderForm(component);\n                    \n                    formBuilderArea.hide();\n                    formContent.show();\n                    btnEditForm.removeClass('disabled');\n                    btnPreviewForm.addClass('disabled');\n                }\n            });\n        },\n        \n        renderForm: function (component, formBuilder) {\n            var formContent = component.find('.form-content');\n            \n            if (!formBuilder) {\n                var formBuilderArea = component.find('.form-builder-area');\n                formBuilder = formBuilderArea.data('formBuilder');\n            }\n            \n            formContent.formRender({\n                dataType: 'json',\n                formData: formBuilder.actions.getData('json')\n            });\n            \n            if (formContent.hasClass('form-horizontal')) {\n                formContent.children('div').each(function () {\n                    var div = $(this);\n                    var dataGrid = formContent.attr('data-grid') || '4-8';\n                    dataGrid = dataGrid.split('-');\n                    \n                    if (div.attr('class')) {\n                        if (div.hasClass('fb-button')) {\n                            div.find('button').wrap('<div class=\"col-sm-' + dataGrid[1] + ' col-sm-offset-' + dataGrid[0] + '\"></div>');\n                        } else {\n                            var label = div.children('label');\n                            var input = div.children('input, select, textarea');\n                            var subDiv = div.children('div');\n                            \n                            label.addClass('control-label col-sm-' + dataGrid[0]);\n                            \n                            if (subDiv.length > 0) {\n                                subDiv.addClass('col-sm-' + dataGrid[1]);\n                            } else {\n                                input.addClass('form-control').wrap('<div class=\"col-sm-' + dataGrid[1] + '\"></div>');\n                            }\n                        }\n                    }\n                });\n            }\n        },\n        \n        init: function (contentArea, container, component, keditor) {\n            flog('init \"form\" component', component);\n            \n            var componentContent = component.find('.keditor-component-content');\n            var formBuilder = component.find('.form-builder-area');\n            var formContent = component.find('.form-content');\n            var formData = component.find('.form-data');\n            \n            if (formData.length === 0) {\n                componentContent.append('<div class=\"form-data\" style=\"display: none !important;\"></div>')\n            }\n            \n            if (formContent.length === 0) {\n                componentContent.append('<form class=\"form-content\" style=\"display: none !important;\"></form>')\n            } else {\n                formContent.hide()\n            }\n            \n            if (formBuilder.length === 0) {\n                formBuilder = $('<div class=\"form-builder-area clearfix\"></div>');\n                componentContent.append(formBuilder);\n            }\n            \n            this.initFormBuilder(component);\n        },\n        \n        getContent: function (component, keditor) {\n            flog('getContent \"form\" component', component);\n            \n            var self = this;\n            var componentContent = component.find('.keditor-component-content');\n            var formData = component.find('.form-data');\n            var formBuilderArea = $('#' + component.attr('id')).find('.form-builder-area');\n            var formBuilder = formBuilderArea.data('formBuilder');\n            \n            self.renderForm(component, formBuilder);\n            formData.html(formBuilder.actions.getData('json'));\n            component.find('.form-builder-area, .form-builder-tools').remove();\n            component.find('.form-content').show();\n            \n            return componentContent.html();\n        },\n        \n        settingEnabled: true,\n        \n        settingTitle: 'Form Settings',\n        \n        initSettingForm: function (form, keditor) {\n            flog('initSettingForm \"form\" component');\n            \n            var self = this;\n            \n            form.html(\n                '<div class=\"form-horizontal\">' +\n                '    <div class=\"form-group\">' +\n                '        <label class=\"col-sm-12\">Action</label>' +\n                '        <div class=\"col-sm-12\">' +\n                '            <input type=\"text\" class=\"form-control txt-form-action\" />' +\n                '        </div>' +\n                '    </div>' +\n                '    <div class=\"form-group\">' +\n                '        <label class=\"col-sm-12\">Method</label>' +\n                '        <div class=\"col-sm-12\">' +\n                '            <select class=\"form-control select-method\">' +\n                '                <option value=\"get\">Get</option>' +\n                '                <option value=\"post\">Post</option>' +\n                '                <option value=\"put\">Put</option>' +\n                '                <option value=\"delete\">Delete</option>' +\n                '            </select>' +\n                '        </div>' +\n                '    </div>' +\n                '    <div class=\"form-group\">' +\n                '        <label class=\"col-sm-12\">Enctype</label>' +\n                '        <div class=\"col-sm-12\">' +\n                '            <select class=\"form-control select-enctype\">' +\n                '                <option value=\"text/plain\">text/plain</option>' +\n                '                <option value=\"multipart/form-data\">multipart/form-data</option>' +\n                '                <option value=\"application/x-www-form-urlencoded\">application/x-www-form-urlencoded</option>' +\n                '            </select>' +\n                '        </div>' +\n                '    </div>' +\n                '    <div class=\"form-group\">' +\n                '        <label class=\"col-sm-12\">Layout</label>' +\n                '        <div class=\"col-sm-12\">' +\n                '            <select class=\"form-control select-layout\">' +\n                '                <option value=\"\">Normal</option>' +\n                '                <option value=\"form-horizontal\">Horizontal</option>' +\n                '                <option value=\"form-inline\">Inline</option>' +\n                '            </select>' +\n                '        </div>' +\n                '    </div>' +\n                '    <div class=\"form-group select-grid-wrapper\">' +\n                '        <label class=\"col-sm-12\">Grid setting</label>' +\n                '        <div class=\"col-sm-12\">' +\n                '            <select class=\"form-control select-grid\">' +\n                '                <option value=\"2-10\">col-2 col-10</option>' +\n                '                <option value=\"3-9\">col-3 col-9</option>' +\n                '                <option value=\"4-8\">col-4 col-8</option>' +\n                '                <option value=\"5-7\">col-5 col-7</option>' +\n                '                <option value=\"6-6\">col-6 col-6</option>' +\n                '            </select>' +\n                '            <small class=\"help-block\">This setting is for width of label and control with number of cols as unit</small>' +\n                '        </div>' +\n                '    </div>' +\n                '</div>'\n            );\n            \n            \n            form.find('.txt-form-action').on('change', function () {\n                var component = keditor.getSettingComponent();\n                var formContent = component.find('.form-content');\n                \n                formContent.attr('action', this.value);\n            });\n            \n            form.find('.select-method').on('change', function () {\n                var component = keditor.getSettingComponent();\n                var formContent = component.find('.form-content');\n                \n                formContent.attr('action', this.value);\n            });\n            \n            form.find('.select-enctype').on('change', function () {\n                var component = keditor.getSettingComponent();\n                var formContent = component.find('.form-content');\n                \n                formContent.attr('enctype', this.value);\n            });\n            \n            form.find('.select-layout').on('change', function () {\n                var component = keditor.getSettingComponent();\n                var formContent = component.find('.form-content');\n                \n                formContent.removeClass('form-inline form-horizontal');\n                if (this.value) {\n                    formContent.addClass(this.value);\n                }\n                self.renderForm(component);\n                form.find('.select-grid-wrapper').css('display', this.value === 'form-horizontal' ? 'block' : 'none');\n            });\n            \n            form.find('.select-grid').on('change', function () {\n                var component = keditor.getSettingComponent();\n                var formContent = component.find('.form-content');\n                \n                formContent.attr('data-grid', this.value);\n                self.renderForm(component);\n            });\n        },\n        \n        showSettingForm: function (form, component, keditor) {\n            flog('showSettingForm \"form\" component', component);\n            var formContent = component.find('.form-content');\n            \n            var layout = '';\n            if (formContent.hasClass('form-inline')) {\n                layout = 'form-inline';\n            } else if (formContent.hasClass('form-horizontal')) {\n                layout = 'form-horizontal';\n            }\n            \n            form.find('.txt-form-action').val(formContent.attr('action') || '');\n            form.find('.select-method').val(formContent.attr('method') || 'get');\n            form.find('.select-enctype').val(formContent.attr('enctype'));\n            form.find('.select-layout').val(layout);\n            form.find('.select-grid-wrapper').css('display', layout === 'form-horizontal' ? 'block' : 'none');\n            form.find('.select-grid').val(formContent.attr('data-grid') || '4-8');\n        }\n    };\n    \n})(jQuery);\n"]}