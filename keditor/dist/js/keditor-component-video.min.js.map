{"version":3,"sources":["keditor-component-video.js"],"names":["$","KEditor","keditor","flog","log","components","init","contentArea","container","component","componentContent","children","video","find","parent","is","wrap","getContent","unwrap","html","settingEnabled","settingTitle","initSettingForm","form","append","showSettingForm","options","fileInput","btnVideoFileInput","on","e","preventDefault","trigger","off","file","this","files","test","type","attr","URL","createObjectURL","load","showSettingPanel","alert","autoplayToggle","checked","prop","removeProp","loopToggle","ratio","currentWidth","css","replace","currentRatio","value","height","showcontrolsToggle","removeAttr","videoWidth","val","jQuery"],"mappings":"CAAA,SAAWA,GACP,GAAIC,GAAUD,EAAEE,QACZC,EAAOF,EAAQG,GAEnBH,GAAQI,WAAkB,OACtBC,KAAM,SAAUC,EAAaC,EAAWC,EAAWP,GAC/CC,EAAK,yBAA0BM,EAE/B,IAAIC,GAAmBD,EAAUE,SAAS,8BACtCC,EAAQF,EAAiBG,KAAK,QAE7BD,GAAME,SAASC,GAAG,mBACnBH,EAAMI,KAAK,sCAInBC,WAAY,SAAUR,EAAWP,GAC7BC,EAAK,+BAAgCM,EAErC,IAAIC,GAAmBD,EAAUE,SAAS,8BACtCC,EAAQF,EAAiBG,KAAK,QAGlC,OAFAD,GAAMM,SAECR,EAAiBS,QAG5BC,gBAAgB,EAEhBC,aAAc,iBAEdC,gBAAiB,SAAUC,EAAMrB,GAC7BC,EAAK,wBAAyBoB,GAE9BA,EAAKC,OACD,2qDA+CRC,gBAAiB,SAAUF,EAAMd,EAAWP,GACxCC,EAAK,mCAAoCoB,EAAMd,EAE/C,IAAIiB,GAAUxB,EAAQwB,QAClBd,EAAQH,EAAUI,KAAK,SACvBc,EAAYJ,EAAKV,KAAK,mBACtBe,EAAoBL,EAAKV,KAAK,sBAClCe,GAAkBC,GAAG,QAAS,SAAUC,GACpCA,EAAEC,iBAEFJ,EAAUK,QAAQ,WAEtBL,EAAUM,IAAI,UAAUJ,GAAG,SAAU,WACjC,GAAIK,GAAOC,KAAKC,MAAM,EAClB,SAAQC,KAAKH,EAAKI,OAGlB1B,EAAM2B,KAAK,MAAOC,IAAIC,gBAAgBP,IAEtCtB,EAAM8B,KAAK,WACPxC,EAAQyC,iBAAiBlC,EAAWiB,MAGxCkB,MAAM,6CAId,IAAIC,GAAiBtB,EAAKV,KAAK,kBAC/BgC,GAAeZ,IAAI,SAASJ,GAAG,QAAS,SAAUC,GAC1CK,KAAKW,QACLlC,EAAMmC,KAAK,YAAY,GAEvBnC,EAAMoC,WAAW,aAIzB,IAAIC,GAAa1B,EAAKV,KAAK,cAC3BoC,GAAWhB,IAAI,SAASJ,GAAG,QAAS,SAAUC,GACtCK,KAAKW,QACLlC,EAAMmC,KAAK,QAAQ,GAEnBnC,EAAMoC,WAAW,SAIzB,IAAIE,GAAQ3B,EAAKV,KAAK,eACtBqC,GAAMjB,IAAI,SAASJ,GAAG,QAAS,SAAUC,GACrC,GAAIK,KAAKW,QAAS,CACd,GAAIK,GAAevC,EAAMwC,IAAI,UAAYxC,EAAMmC,KAAK,QACpDI,GAAeA,EAAaE,QAAQ,KAAM,GAE1C,IAAIC,GAA8B,SAAfnB,KAAKoB,MAAmB,GAAK,EAAI,EAAI,EACpDC,EAASL,EAAeG,CAC5B1C,GAAMwC,IAAI,QAASD,EAAe,MAClCvC,EAAMwC,IAAI,SAAUI,EAAS,MAC7B5C,EAAMoC,WAAW,SACjBpC,EAAMoC,WAAW,YAIzB,IAAIS,GAAqBlC,EAAKV,KAAK,sBACnC4C,GAAmBxB,IAAI,SAASJ,GAAG,QAAS,SAAUC,GAC9CK,KAAKW,QACLlC,EAAM2B,KAAK,WAAY,YAEvB3B,EAAM8C,WAAW,aAIzB,IAAIC,GAAapC,EAAKV,KAAK,eAC3B8C,GAAW1B,IAAI,UAAUJ,GAAG,SAAU,WAClCjB,EAAMwC,IAAI,QAASjB,KAAKoB,MAAQ,KAChC,IAAID,GAA2D,SAA5C/B,EAAKV,KAAK,wBAAwB+C,MAAmB,GAAK,EAAI,EAAI,EACjFJ,EAASrB,KAAKoB,MAAQD,CAC1B1C,GAAMwC,IAAI,SAAUI,EAAS,MAC7B5C,EAAMoC,WAAW,SACjBpC,EAAMoC,WAAW,eAI9Ba","file":"keditor-component-video.min.js","sourcesContent":["(function ($) {\n    var KEditor = $.keditor;\n    var flog = KEditor.log;\n\n    KEditor.components['video'] = {\n        init: function (contentArea, container, component, keditor) {\n            flog('init \"video\" component', component);\n\n            var componentContent = component.children('.keditor-component-content');\n            var video = componentContent.find('video');\n\n            if (!video.parent().is('.video-wrapper')) {\n                video.wrap('<div class=\"video-wrapper\"></div>');\n            }\n        },\n\n        getContent: function (component, keditor) {\n            flog('getContent \"video\" component', component);\n\n            var componentContent = component.children('.keditor-component-content');\n            var video = componentContent.find('video');\n            video.unwrap();\n\n            return componentContent.html();\n        },\n\n        settingEnabled: true,\n\n        settingTitle: 'Video Settings',\n\n        initSettingForm: function (form, keditor) {\n            flog('init \"video\" settings', form);\n\n            form.append(\n                '<form class=\"form-horizontal\">' +\n                '    <div class=\"form-group\">' +\n                '        <label for=\"videoFileInput\" class=\"col-sm-12\">Video file</label>' +\n                '        <div class=\"col-sm-12\">' +\n                '            <div class=\"video-toolbar\">' +\n                '                <a href=\"#\" class=\"btn-videoFileInput btn btn-sm btn-primary\"><i class=\"fa fa-upload\"></i></a>' +\n                '                <input id=\"videoFileInput\" type=\"file\" style=\"display: none\">' +\n                '            </div>' +\n                '        </div>' +\n                '    </div>' +\n                '    <div class=\"form-group\">' +\n                '        <label for=\"video-autoplay\" class=\"col-sm-12\">Autoplay</label>' +\n                '        <div class=\"col-sm-12\">' +\n                '            <input type=\"checkbox\" id=\"video-autoplay\" />' +\n                '        </div>' +\n                '    </div>' +\n                '    <div class=\"form-group\">' +\n                '        <label for=\"video-loop\" class=\"col-sm-12\">Loop</label>' +\n                '        <div class=\"col-sm-12\">' +\n                '            <input type=\"checkbox\" id=\"video-loop\" />' +\n                '        </div>' +\n                '    </div>' +\n                '    <div class=\"form-group\">' +\n                '        <label for=\"video-showcontrols\" class=\"col-sm-12\">Show Controls</label>' +\n                '        <div class=\"col-sm-12\">' +\n                '            <input type=\"checkbox\" id=\"video-showcontrols\" checked />' +\n                '        </div>' +\n                '    </div>' +\n                '    <div class=\"form-group\">' +\n                '        <label for=\"\" class=\"col-sm-12\">Ratio</label>' +\n                '        <div class=\"col-sm-12\">' +\n                '            <input type=\"radio\" name=\"video-radio\" class=\"video-ratio\" value=\"4/3\" checked /> 4:3' +\n                '        </div>' +\n                '        <div class=\"col-sm-12\">' +\n                '            <input type=\"radio\" name=\"video-radio\" class=\"video-ratio\" value=\"16/9\" /> 16:9' +\n                '        </div>' +\n                '    </div>' +\n                '    <div class=\"form-group\">' +\n                '        <label for=\"video-width\" class=\"col-sm-12\">Width (px)</label>' +\n                '        <div class=\"col-sm-12\">' +\n                '            <input type=\"number\" id=\"video-width\" min=\"320\" max=\"1920\" class=\"form-control\" value=\"320\" />' +\n                '        </div>' +\n                '    </div>' +\n                '</form>'\n            );\n        },\n\n        showSettingForm: function (form, component, keditor) {\n            flog('showSettingForm \"video\" settings', form, component);\n\n            var options = keditor.options;\n            var video = component.find('video');\n            var fileInput = form.find('#videoFileInput');\n            var btnVideoFileInput = form.find('.btn-videoFileInput');\n            btnVideoFileInput.on('click', function (e) {\n                e.preventDefault();\n\n                fileInput.trigger('click');\n            });\n            fileInput.off('change').on('change', function () {\n                var file = this.files[0];\n                if (/video/.test(file.type)) {\n                    // Todo: Upload to your server :)\n\n                    video.attr('src', URL.createObjectURL(file));\n\n                    video.load(function () {\n                        keditor.showSettingPanel(component, options);\n                    });\n                } else {\n                    alert('Your selected file is not an video file!');\n                }\n            });\n\n            var autoplayToggle = form.find('#video-autoplay');\n            autoplayToggle.off('click').on('click', function (e) {\n                if (this.checked) {\n                    video.prop('autoplay', true);\n                } else {\n                    video.removeProp('autoplay');\n                }\n            });\n\n            var loopToggle = form.find('#video-loop');\n            loopToggle.off('click').on('click', function (e) {\n                if (this.checked) {\n                    video.prop('loop', true);\n                } else {\n                    video.removeProp('loop');\n                }\n            });\n\n            var ratio = form.find('.video-ratio');\n            ratio.off('click').on('click', function (e) {\n                if (this.checked) {\n                    var currentWidth = video.css('width') || video.prop('width');\n                    currentWidth = currentWidth.replace('px', '');\n\n                    var currentRatio = this.value === '16/9' ? 16 / 9 : 4 / 3;\n                    var height = currentWidth / currentRatio;\n                    video.css('width', currentWidth + 'px');\n                    video.css('height', height + 'px');\n                    video.removeProp('width');\n                    video.removeProp('height');\n                }\n            });\n\n            var showcontrolsToggle = form.find('#video-showcontrols');\n            showcontrolsToggle.off('click').on('click', function (e) {\n                if (this.checked) {\n                    video.attr('controls', 'controls');\n                } else {\n                    video.removeAttr('controls');\n                }\n            });\n\n            var videoWidth = form.find('#video-width');\n            videoWidth.off('change').on('change', function () {\n                video.css('width', this.value + 'px');\n                var currentRatio = form.find('.video-ratio:checked').val() === '16/9' ? 16 / 9 : 4 / 3;\n                var height = this.value / currentRatio;\n                video.css('height', height + 'px');\n                video.removeProp('width');\n                video.removeProp('height');\n            });\n        }\n    };\n})(jQuery);\n"]}